<VirtualHost 0.0.0.0:80>
    ## MAIN SETTINGS:
    ServerAdmin pslearner@localhost
    ErrorLog /var/log/apache2/error.log
    CustomLog /var/log/apache2/access.log combined
    ServerName localhost
    DocumentRoot /var/www/html/
    RewriteEngine On
    SSLProxyEngine On
    SSLEngine off
    SSLProxyCheckPeerCN Off
    SSLProxyVerify none
    SSLProxyCheckPeerName off
    SSLProxyCheckPeerExpire off
    ## 1 DETECTION SETTINGS:
#   SecRuleEngine DetectionOnly
#   SecRule REQUEST_URI "@contains batch-requests" \
#      "id:'2022241121',phase:2,t:none,log,pass,status:403,msg:'CVE-2022-24112 - detected',chain"
#      SecRule REQUEST_BODY "pipeline" "chain"
#      SecRule &REQUEST_HEADERS_NAMES:X-API-KEY "@gt 0" "chain"
#      SecRule REQUEST_HEADERS_NAMES:X-Real-IP "@eq 127.0.0.1" "chain"
#      SecRule REQUEST_BODY "@contains pipeline" "chain"
#      SecRule REQUEST_BODY "@rx (.*os.execute.*)"
    ## 2 PREVENTION SETTINGS:
#   SecRuleEngine On
#   SecRule REQUEST_URI "@contains batch-requests" \
#      "id:'2022241122',phase:2,t:none,log,deny,status:403,msg:'CVE-2022-24112 - prevented',chain"
#      SecRule REQUEST_BODY "pipeline" "chain"
#      SecRule &REQUEST_HEADERS_NAMES:X-API-KEY "@gt 0" "chain"
#      SecRule REQUEST_HEADERS_NAMES:X-Real-IP "@eq 127.0.0.1" "chain"
#      SecRule REQUEST_BODY "@contains pipeline" "chain"
#      SecRule REQUEST_BODY "@rx (.*os.execute.*)"
    # MAIN SETTINGS:
    RewriteRule ^(.*) http://127.0.0.1:9080/$1 [NC,L,P]
</VirtualHost>